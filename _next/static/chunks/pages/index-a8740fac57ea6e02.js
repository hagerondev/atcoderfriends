(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8581:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4369)}])},4369:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var r=n(4051),s=n.n(r),a=n(5893),c=(n(9008),n(1163)),o=n(1664),i=n(3328),l=n(5376),d=n(7294);n(3461);function u(e,t,n,r,s,a,c){try{var o=e[a](c),i=o.value}catch(l){return void n(l)}o.done?t(i):Promise.resolve(i).then(r,s)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function c(e){u(a,r,s,c,o,"next",e)}function o(e){u(a,r,s,c,o,"throw",e)}c(void 0)}))}}i.kL.register(i.qi,i.u,i.De);var x={};function f(){return(f=h(s().mark((function e(t,n){var r,c,i,l,d,u,h,f,p,v,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=3;break}return n((0,a.jsx)("div",{children:"\u8aad\u307f\u8fbc\u307f\u4e2d"})),e.abrupt("return");case 3:r=t.split(","),c=!0,i=!1,l=void 0,e.prev=5,d=r[Symbol.iterator]();case 7:if(c=(u=d.next()).done){e.next=23;break}return h=u.value,f="https://kyopro-ratings.herokuapp.com/json?atcoder="+h,e.next=12,fetch(f);case 12:return p=e.sent,e.next=15,p.json();case 15:return v=e.sent,m=v.atcoder.color,x[h]=m,e.next=20,new Promise((function(e){return setTimeout(e,300)}));case 20:c=!0,e.next=7;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(5),i=!0,l=e.t0;case 29:e.prev=29,e.prev=30,c||null==d.return||d.return();case 32:if(e.prev=32,!i){e.next=35;break}throw l;case 35:return e.finish(32);case 36:return e.finish(29);case 37:n((0,a.jsxs)("div",{className:"text-center text-lg lg:text-xl",children:[(0,a.jsx)("div",{children:"\u53c2\u52a0\u8005"}),(0,a.jsx)("div",{children:Object.keys(x).map((function(e){var t=x[e];return(0,a.jsx)(o.default,{href:"https://atcoder.jp/users/"+e,children:(0,a.jsx)("a",{className:"mx-2 hover:underline",style:{color:t},children:e})},e+t)}))})]}));case 38:case"end":return e.stop()}}),e,null,[[5,25,29,37],[30,,32,36]])})))).apply(this,arguments)}function p(e){var t={};t.labels=e,t.datasets=[{}],t.datasets[0].label="# of Votes",t.datasets[0].backgroundColor=[],t.datasets[0].borderColor=[];var n=!0,r=!1,s=void 0;try{for(var a,c=[[255,99,132],[54,162,235],[255,206,86],[75,192,192],[153,102,255],[255,159,64]][Symbol.iterator]();!(n=(a=c.next()).done);n=!0){var o=a.value;t.datasets[0].backgroundColor.push("rgba(".concat(o[0],",").concat(o[1],",").concat(o[2],",0.5)")),t.datasets[0].borderColor.push("rgba(".concat(o[0],",").concat(o[1],",").concat(o[2],",1)"))}}catch(i){r=!0,s=i}finally{try{n||null==c.return||c.return()}finally{if(r)throw s}}return t.datasets[0].borderWidth=1,t}var v=function(e){var t=new Date(1e3*e);return t.toLocaleDateString()+"\n"+t.toLocaleTimeString()};function m(e,t){return b.apply(this,arguments)}function b(){return b=h(s().mark((function e(t,n){var r,a,c,o,i,l,d,u,h,x,f,p,v,m,b,j,g,_,N,k,y=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=y.length>2&&void 0!==y[2]?y[2]:-1,a=y.length>3&&void 0!==y[3]?y[3]:-1,void 0!==t){e.next=3;break}return e.abrupt("return",null);case 3:-1==a&&(a=(new Date).getTime()/1e3),c={labels:[],point_data:[],cnt_data:[]},o=[],i=!0,l=!1,d=void 0,e.prev=7,u=t.split(",")[Symbol.iterator]();case 9:if(i=(h=u.next()).done){e.next=50;break}return x=h.value,f="https://kenkoooo.com/atcoder/atcoder-api/v3/user/submissions?user=".concat(x,"&from_second=").concat(r),e.next=14,fetch(f);case 14:return p=e.sent,e.next=17,p.json();case 17:for(v=e.sent,c.labels.push(x),m=0,0,b=!0,j=!1,g=void 0,e.prev=22,_=v[Symbol.iterator]();!(b=(N=_.next()).done);b=!0)(k=N.value).epoch_second<=a&&"AC"===k.result&&(k.point%10===0&&k.point<=5e3||-1!==k.problem_id.indexOf("abc")||-1!==k.problem_id.indexOf("arc")||-1!==k.problem_id.indexOf("agc"))&&(m+=k.point,o.push(k));e.next=30;break;case 26:e.prev=26,e.t0=e.catch(22),j=!0,g=e.t0;case 30:e.prev=30,e.prev=31,b||null==_.return||_.return();case 33:if(e.prev=33,!j){e.next=36;break}throw g;case 36:return e.finish(33);case 37:return e.finish(30);case 38:if(c.point_data.push(m),c.cnt_data.push(v.length),t.split(",").length!==c.labels.length){e.next=45;break}return o.sort((function(e,t){return t.epoch_second-e.epoch_second})),c.hist=o,n(c),e.abrupt("return",c);case 45:return e.next=47,new Promise((function(e){return setTimeout(e,300)}));case 47:i=!0,e.next=9;break;case 50:e.next=56;break;case 52:e.prev=52,e.t1=e.catch(7),l=!0,d=e.t1;case 56:e.prev=56,e.prev=57,i||null==u.return||u.return();case 59:if(e.prev=59,!l){e.next=62;break}throw d;case 62:return e.finish(59);case 63:return e.finish(56);case 64:case"end":return e.stop()}}),e,null,[[7,52,56,64],[22,26,30,38],[31,,33,37],[57,,59,63]])}))),b.apply(this,arguments)}function j(){var e,t,n=(0,c.useRouter)().query,r=(0,d.useState)({}),s=r[0],i=r[1],u=(0,d.useState)(null),h=u[0],b=u[1],j=(0,d.useState)(null),g=j[0],_=j[1],N=(0,d.useState)(null),k=N[0],y=N[1],w=(0,d.useState)(-1),S=w[0],C=w[1],E=(0,d.useState)(null),O=E[0],P=E[1];return(0,d.useEffect)((function(){void 0!==s.hist&&0!==s.hist.length&&S!=s.hist[0].epoch_second?(console.log("new data"),C(s.hist[0].epoch_second)):console.log("latest")}),[s]),(0,d.useEffect)((function(){b(function(e){var t=p(e.labels);return t.datasets[0].data=e.point_data,(0,a.jsx)(l.by,{data:t})}(s)),_(function(e){var t=p(e.labels);return t.datasets[0].data=e.cnt_data,(0,a.jsx)(l.by,{data:t})}(s)),y(function(e){if(void 0===e.hist)return null;var t=function(e){var t=e.split("_"),n=t.slice(0,-1).join("_");return(n.length>6?n.slice(0,6)+"..":n)+"-"+t[t.length-1]};return console.log(e),console.log(x),(0,a.jsx)("tbody",{children:e.hist.map((function(e){return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"w-1/3 px-1",children:v(e.epoch_second)}),(0,a.jsx)("td",{className:"w-1/3 px-1",children:(0,a.jsx)(o.default,{href:"https://atcoder.jp/contests/".concat(e.contest_id,"/tasks/").concat(e.problem_id),children:(0,a.jsx)("a",{className:"hover:underline",children:t(e.problem_id.toUpperCase())})})}),(0,a.jsx)("td",{className:"w-1/3 px-1",children:(0,a.jsx)(o.default,{href:"https://atcoder.jp/contests/".concat(e.contest_id,"/submissions/").concat(e.id),children:(0,a.jsx)("a",{className:"hover:underline",style:{color:x[e.user_id.toLowerCase()]},children:e.user_id})})})]},e.id)}))})}(s))}),[S]),(0,d.useEffect)((function(){void 0!==n.friends&&Object.keys(x).length==n.friends.split(",").length&&(m(n.friends,i,n.start,n.end),setInterval((function(){m(n.friends,i,n.start,n.end)}),1e4+300*n.friends.split(",").length))}),[O]),(0,d.useEffect)((function(){!function(e,t){f.apply(this,arguments)}(n.friends,P)}),[n]),(0,a.jsxs)("div",{className:"text-center mx-auto",children:[(0,a.jsx)("div",{className:"bg-white/95 fixed top-0 left-0 right-0 bottom-0 z-10"}),(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 bottom-0 z-0",style:{backgroundImage:"url(./atcoder.svg)"}}),(0,a.jsxs)("div",{className:"relative z-50 max-w-screen-sm mx-auto",children:[(0,a.jsx)("h1",{className:"text-center text-2xl lg:text-4xl mt-4 font-bold",children:"AtCoder Friends"}),n.contest?(0,a.jsxs)("h2",{className:"text-center text-2xl lg:text-3xl my-2",children:["\u300c",n.contest,"\u300d"]}):null,(0,a.jsx)("div",{className:"p-2 my-2",children:O}),(0,a.jsx)("div",{className:"p-2 my-2",children:(e=n.start,t=n.end,void 0===e||void 0===t?null:(0,a.jsxs)("div",{className:"text-center text-lg lg:text-xl",children:[(0,a.jsx)("div",{children:"\u671f\u9593"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:v(e)})," \uff5e ",(0,a.jsx)("span",{className:"inline-block",children:v(t)})]})]}))}),(0,a.jsxs)("div",{className:"lg:flex justify-center flex-row",children:[(0,a.jsxs)("div",{className:"border-gray-500 border-2 rounded-lg p-4 m-4 basis-160",children:[(0,a.jsx)("h2",{className:"text-center text-xl mb-2",children:"\u5408\u8a08\u5f97\u70b9"}),(0,a.jsx)("div",{className:"max-w-sm mx-auto",children:h})]}),(0,a.jsxs)("div",{className:"border-gray-500 border-2 rounded-lg p-4 m-4",children:[(0,a.jsx)("h2",{className:"text-center text-xl mb-2",children:"\u89e3\u3044\u305f\u554f\u984c\u6570"}),(0,a.jsx)("div",{className:"mx-auto max-w-sm",children:g})]})]}),(0,a.jsxs)("div",{className:"border-gray-500 border-2 rounded-lg p-4 m-4",children:[(0,a.jsx)("h2",{className:"text-center text-xl mb-2",children:"\u5c65\u6b74"}),(0,a.jsx)("table",{className:"mx-auto",children:k})]})]})]})}}},function(e){e.O(0,[570,890,774,888,179],(function(){return t=8581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);